{"ast":null,"code":"import _toConsumableArray from\"E:/DjangoEcommerce/backend/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import React,{useEffect,useEfffect}from\"react\";import{Link}from\"react-router-dom\";import{useDispatch,useSelector}from\"react-redux\";import{Row,Col,ListGroup,Image,Form,Button,Card}from\"react-bootstrap\";import Message from\"../components/Message\";import{addToCart,removeFromCart}from\"../actions/cartActions\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function CartScreen(_ref){var match=_ref.match,location=_ref.location,history=_ref.history;var productId=match.params.id;var qty=location.search?Number(location.search.split(\"=\")[1]):1;var dispatch=useDispatch();var cart=useSelector(function(state){return state.cart;});var cartItems=cart.cartItems;useEffect(function(){if(productId){dispatch(addToCart(productId,qty));}},[dispatch,productId,qty]);var removeFromCartHandler=function removeFromCartHandler(id){dispatch(removeFromCart(id));};var checkoutHandler=function checkoutHandler(){history.push('/login?redirect=shipping');};return/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsxs(Col,{md:8,children:[/*#__PURE__*/_jsx(\"h1\",{children:\"\\u041A\\u043E\\u0440\\u0437\\u0438\\u043D\\u0430\"}),cartItems.length===0?/*#__PURE__*/_jsxs(Message,{children:[\"\\u0412\\u0430\\u0448\\u0430 \\u043A\\u043E\\u0440\\u0437\\u0438\\u043D\\u0430 \\u043F\\u0443\\u0441\\u0442\\u0430 \",/*#__PURE__*/_jsx(Link,{to:\"/\",style:{textDecoration:'none',color:'red'},children:\"\\u041D\\u0430\\u0437\\u0430\\u0434\"})]}):/*#__PURE__*/_jsx(ListGroup,{variant:\"flush\",children:cartItems.map(function(item){return/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{md:2,children:/*#__PURE__*/_jsx(Image,{src:item.image,alt:item.name,fluid:true,rounded:true})}),/*#__PURE__*/_jsx(Col,{md:3,children:/*#__PURE__*/_jsx(Link,{to:\"/product/\".concat(item.product),style:{textDecoration:'none'},children:item.name})}),/*#__PURE__*/_jsxs(Col,{md:2,children:[\"$\",item.price]}),/*#__PURE__*/_jsx(Col,{md:3,children:/*#__PURE__*/_jsx(Form.Select,{as:\"select\",value:item.qty,onChange:function onChange(e){return dispatch(addToCart(item.product,Number(e.target.value)));},children:_toConsumableArray(Array(item.countInStock).keys()).map(function(x){return/*#__PURE__*/_jsx(\"option\",{value:x+1,children:x+1},x+1);})})}),/*#__PURE__*/_jsx(Col,{md:1,children:/*#__PURE__*/_jsx(Button,{type:\"button\",variant:\"light\",onClick:function onClick(){return removeFromCartHandler(item.product);},children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-trash\"})})})]})},item.product);})})]}),/*#__PURE__*/_jsx(Col,{md:4,children:/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsx(ListGroup,{className:true,variant:\"flush\",children:/*#__PURE__*/_jsxs(ListGroup.Item,{children:[/*#__PURE__*/_jsxs(\"h2\",{children:[\"\\u041A\\u043E\\u043B\\u0438\\u0447\\u0435\\u0441\\u0442\\u0432\\u043E (\",cartItems.reduce(function(acc,item){return acc+item.qty;},0),\")\"]}),\"$\",cartItems.reduce(function(acc,item){return acc+item.qty*item.price;},0).toFixed(2)]})}),/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Button,{type:\"button\",className:\"btn-block\",disabled:cartItems.length===0,onClick:checkoutHandler,children:\"\\u041F\\u0435\\u0440\\u0435\\u0439\\u0442\\u0438 \\u043A \\u0437\\u0430\\u043A\\u0430\\u0437\\u0443\"})})})]})})]});}export default CartScreen;","map":{"version":3,"sources":["E:/DjangoEcommerce/backend/frontend/src/screens/CartScreen.js"],"names":["React","useEffect","useEfffect","Link","useDispatch","useSelector","Row","Col","ListGroup","Image","Form","Button","Card","Message","addToCart","removeFromCart","CartScreen","match","location","history","productId","params","id","qty","search","Number","split","dispatch","cart","state","cartItems","removeFromCartHandler","checkoutHandler","push","length","textDecoration","color","map","item","image","name","product","price","e","target","value","Array","countInStock","keys","x","reduce","acc","toFixed"],"mappings":"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","sourcesContent":["import React, { useEffect, useEfffect } from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport {\r\n  Row,\r\n  Col,\r\n  ListGroup,\r\n  Image,\r\n  Form,\r\n  Button,\r\n  Card,\r\n} from \"react-bootstrap\";\r\nimport Message from \"../components/Message\";\r\nimport { addToCart, removeFromCart } from \"../actions/cartActions\";\r\n\r\nfunction CartScreen({ match, location, history }) {\r\n  const productId = match.params.id;\r\n  const qty = location.search ? Number(location.search.split(\"=\")[1]) : 1;\r\n  const dispatch = useDispatch();\r\n\r\n  const cart = useSelector((state) => state.cart);\r\n  const { cartItems } = cart;\r\n\r\n  useEffect(() => {\r\n    if (productId) {\r\n      dispatch(addToCart(productId, qty));\r\n    }\r\n  }, [dispatch, productId, qty]);\r\n\r\n\r\n  const removeFromCartHandler =(id) => {\r\n    dispatch(removeFromCart(id))\r\n  }\r\n\r\n  const checkoutHandler =() => {\r\n      history.push('/login?redirect=shipping')\r\n  }\r\n\r\n  return (\r\n    \r\n    <Row>\r\n      <Col md={8}>\r\n        <h1>Корзина</h1>\r\n        {cartItems.length === 0 ? (\r\n          <Message>\r\n            Ваша корзина пуста <Link to=\"/\" style={{ textDecoration: 'none' , color:'red'}} >Назад</Link>\r\n          </Message>\r\n        ) : (\r\n          <ListGroup variant=\"flush\">\r\n            {cartItems.map((item) => (\r\n              <ListGroup.Item key={item.product}>\r\n                <Row>\r\n                  <Col md={2}>\r\n                    <Image src={item.image} alt={item.name} fluid rounded />\r\n                  </Col>\r\n                  <Col md={3}>\r\n                    <Link to={`/product/${item.product}`} style ={{ textDecoration: 'none' }}>{item.name}</Link>\r\n                  </Col>\r\n\r\n                  <Col md={2}>${item.price}</Col>\r\n                  <Col md={3}>\r\n                    <Form.Select\r\n                      as=\"select\"\r\n                      value={item.qty}\r\n                      onChange={(e) => dispatch(addToCart(item.product, Number(e.target.value)))}\r\n                    >\r\n                      {[...Array(item.countInStock).keys()].map((x) => (\r\n                        <option key={x + 1} value={x + 1}>\r\n                          {x + 1}\r\n                        </option>\r\n                      ))}\r\n                    </Form.Select>\r\n                  </Col>\r\n\r\n                  <Col md={1}>\r\n                      <Button\r\n                            type='button'\r\n                            variant='light'\r\n                            onClick={() => removeFromCartHandler(item.product)}\r\n                        >\r\n                            <i className=\"fas fa-trash\"></i>\r\n                        </Button>\r\n                  </Col>\r\n                </Row>\r\n              </ListGroup.Item>\r\n            ))}\r\n          </ListGroup>\r\n        )}\r\n      </Col>\r\n      <Col md={4}>\r\n          <Card>\r\n              <ListGroup className variant=\"flush\">\r\n                  <ListGroup.Item>\r\n                      <h2>Количество ({cartItems.reduce((acc, item) => acc + item.qty, 0)})</h2>\r\n                      ${cartItems.reduce((acc, item) => acc + item.qty * item.price, 0).toFixed(2)}\r\n                  </ListGroup.Item>\r\n              </ListGroup>\r\n              <ListGroup.Item>\r\n                <Row>\r\n                  <Button\r\n                    type=\"button\"\r\n                    className=\"btn-block\"\r\n                    disabled={cartItems.length === 0}\r\n                    onClick={checkoutHandler}\r\n                    >\r\n                        Перейти к заказу\r\n\r\n                  </Button>\r\n                  </Row>\r\n              </ListGroup.Item>\r\n          </Card>\r\n      </Col>\r\n    </Row>\r\n    \r\n  );\r\n}\r\n\r\nexport default CartScreen;\r\n"]},"metadata":{},"sourceType":"module"}